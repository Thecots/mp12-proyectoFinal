<form>
  <main class="crearpost">
    <h1>Nuevo tema</h1>
    <h2>Foro: <a style="color: rgb(255, 45, 8);" href="/foros/<%= data.id%>/1/"><%= data.foro%></a></h2>
    <div>
      <h2>Título:</h2>
      <input type="text" class="title" required placeholder="Escribe aquí el titulo...">
    </div>
    <div class="edtior" data-tiny-editor
          data-fontname="no">
      <p>
      
      </p>
    </div>
    <button class="button" type="submit">Publicar mensaje</button>
  </main>
</form>
<script src="//cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script src="/js/editor.js"></script>
<script>
  document.querySelector('form').addEventListener('submit', e => {
    e.preventDefault();
    titulo = document.querySelector('.title');
    content = document.querySelector('.__editor');
    fetch('/save_post',
          {method: 'POST',
          body: JSON.stringify({
            foro: <%= data.id %>,
            title:  document.querySelector('.title').value,
            content: document.querySelector('.__editor').innerHTML
          }),
          headers:{
            'Content-Type': 'application/json'
          }}
        ).then(res => res.json())
        .then(res => {
         if(res.ok){
          Swal.fire(
            'Post creado correctamente',
            '',
            'success',
          ).then(() => {
            window.location.href = '/foros/<%= data.id %>/1/'
          })
         }else{
          Swal.fire(
            'Ha ocurrido un error',
            '',
            'error',
            )
         }
      });
  })
</script>

